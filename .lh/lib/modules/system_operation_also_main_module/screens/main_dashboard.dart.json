{
    "sourceFile": "lib/modules/system_operation_also_main_module/screens/main_dashboard.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1726318175007,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1726318175007,
            "name": "Commit-0",
            "content": "import 'package:flutter/material.dart';\r\nimport 'package:provider/provider.dart';\r\nimport '../../system_diagram_view_module/widgets/component_control_overlay.dart';\r\nimport '../../system_diagram_view_module/widgets/system_diagram_view.dart';\r\nimport '../providers/operation_experiment_planner_provider.dart';\r\nimport '../providers/recipe_provider.dart' as provider;\r\nimport '../providers/alarm_provider.dart';\r\nimport '../widgets/parameter_display.dart';\r\nimport '../widgets/recipe_control.dart';\r\nimport '../widgets/alarm_display.dart';\r\nimport '../widgets/data_visualization.dart';\r\nimport '../widgets/system_diagram.dart';\r\nimport 'recipe_management_screen.dart';\r\nimport '../models/recipe.dart' as model;\r\n\r\nclass MainDashboard extends StatelessWidget {\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    return DefaultTabController(\r\n      length: 4, // Number of tabs\r\n      child: Scaffold(\r\n        appBar: AppBar(\r\n          title: Text('ALD Process Monitor'),\r\n          bottom: TabBar(\r\n            tabs: [\r\n              Tab(icon: Icon(Icons.dashboard), text: 'Overview'),\r\n              Tab(icon: Icon(Icons.science), text: 'Recipe Control'),\r\n              Tab(icon: Icon(Icons.warning), text: 'Alarms'),\r\n              Tab(icon: Icon(Icons.analytics), text: 'Data'),\r\n            ],\r\n          ),\r\n        ),\r\n        // Removed the drawer from here\r\n        body: TabBarView(\r\n          children: [\r\n            _buildOverviewTab(context),\r\n            _buildRecipeControlTab(context),\r\n            AlarmDisplay(),\r\n            DataVisualization(),\r\n          ],\r\n        ),\r\n        floatingActionButton: FloatingActionButton(\r\n          child: Icon(Icons.stop),\r\n          backgroundColor: Colors.red,\r\n          onPressed: () => _handleEmergencyStop(context),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n\r\n  Widget _buildOverviewTab(BuildContext context) {\r\n    return Column(\r\n      children: [\r\n        Expanded(\r\n          flex: 4,\r\n          child: Padding(\r\n            padding: const EdgeInsets.all(16.0),\r\n            child: SystemDiagramView(\r\n              overlay: ComponentControlOverlay(),\r\n            ),\r\n          ),\r\n        ),\r\n        Expanded(\r\n          flex: 3,\r\n          child: Padding(\r\n            padding: const EdgeInsets.all(16.0),\r\n            child: ParameterDisplay(),\r\n          ),\r\n        ),\r\n      ],\r\n    );\r\n  }\r\n\r\n  Widget _buildRecipeControlTab(BuildContext context) {\r\n    return RecipeControl(\r\n      onStartRecipe: (model.Recipe recipe) {\r\n        final systemStateProvider = Provider.of<SystemStateProvider>(context, listen: false);\r\n        final recipeProvider = Provider.of<provider.RecipeProvider>(context, listen: false);\r\n        recipeProvider.startRecipe(\r\n              (parameters) => systemStateProvider.handleRecipeStep(parameters),\r\n        );\r\n      },\r\n    );\r\n  }\r\n\r\n  void _handleEmergencyStop(BuildContext context) {\r\n    Provider.of<SystemStateProvider>(context, listen: false).emergencyStop();\r\n    Provider.of<provider.RecipeProvider>(context, listen: false).stopRecipe();\r\n    Provider.of<AlarmProvider>(context, listen: false).addAlarm(\r\n      'Emergency stop activated',\r\n      AlarmSeverity.critical,\r\n    );\r\n    ScaffoldMessenger.of(context).showSnackBar(\r\n      SnackBar(\r\n        content: Text('Emergency Stop Activated!'),\r\n        backgroundColor: Colors.red,\r\n        duration: Duration(seconds: 5),\r\n      ),\r\n    );\r\n  }\r\n}\r\n"
        }
    ]
}